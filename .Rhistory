circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 1)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
circos.par(start.degree=90)
circos.genomicInitialize(cvv.chroms,plotType = NULL,)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
circos.par(start.degree=90)
circos.genomicInitialize(cvv.chroms)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
circos.par(start.degree=90,gap.degree=rep(c(2, 4), 12))
circos.genomicInitialize(cvv.chroms)
?rep
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
circos.clear()
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = c('axis'))
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside")
circos.genomicLabels(cvv.chroms$chr, side = "inside")
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = c('axis'))
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
circos.genomicLabels(cvv.chroms$chr, side = "inside")
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = c('axis'))
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
circos.genomicLabels(cvv.chroms$chr, side = "inside")
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = c('axis'))
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside")
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = c('axis'))
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = c('axis'))
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 2)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = c('axis'))
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
###### Run this whole block together each time
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = c('axis'))
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
######
###### Run this whole block together each time
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = c('axis'))
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1)
circos.genomicAxis(side='inside')
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
######
###### Run this whole block together each time
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = NULL)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1)
circos.genomicAxis()
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
###### Run this whole block together each time
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = c('axis'))
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
######
test <- read_tsv('../_VenomGeneRegulation_OLD/misc/Circos_plots/data/SVMP/Gene_expression/VG1DPE_AvgExpression_log2.bedgraph')
test <- read_tsv('../_VenomGeneRegulation_OLD/misc/Circos_plots/data/SVMP/Gene_expression/VG1DPE_AvgExpression_log2.bedgraph',col_names = c('chr','start','end','expression'))
circos.genomicLines(test)
###### Run this whole block together each time
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = c('axis'))
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1)
circos.genomicLines(test)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
######
circos.genomicLines(region = test[,2:3],value = test$expression)
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = c('axis'))
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1)
circos.genomicLines(region = test[,2:3],value = test$expression)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
######
###### Run this whole block together each time
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = c('axis'))
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08,panel.fun = function(x, y) {
circos.genomicAxis(h = "bottom", direction = "inside")}
)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
######
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = NULL)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08,panel.fun = function(x, y) {
circos.genomicAxis(h = "bottom", direction = "inside")}
)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
######
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = NULL)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08,panel.fun = function(x, y) {
circos.genomicAxis(h = "bottom", direction = "inside")}
)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1,line_lwd = 0)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
######
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = NULL)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08,panel.fun = function(x, y) {
circos.genomicAxis(h = "bottom", direction = "inside",labels.cex = 1)}
)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1,line_lwd = 0)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
######
###### Run this whole block together each time
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = NULL)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08,panel.fun = function(x, y) {
circos.genomicAxis(h = "bottom", direction = "inside",labels.cex = 0.05)}
)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1,line_lwd = 0)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
######
###### Run this whole block together each time
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = NULL)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08,panel.fun = function(x, y) {
circos.genomicAxis(h = "bottom", direction = "inside",labels.cex = 0.5)}
)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1,line_lwd = 0)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
######
cvv.exp <- read_tsv('analysis/1_gene_expression/norm_counts/CvvVenomReg_RepRNAseq_wNonVen_VSTNormCounts_08.02.21.csv')
cvv.exp <- read_csv('analysis/1_gene_expression/norm_counts/CvvVenomReg_RepRNAseq_wNonVen_VSTNormCounts_08.02.21.csv')
cvv.exp <- read_csv('analysis/1_gene_expression/norm_counts/CvvVenomReg_RepRNAseq_wNonVen_VSTNormCounts_08.02.21.csv') %>%
mutate(avg1DPE = rowMeans(.[,c(4,8,9)]))
View(cvv.exp)
cvv.exp <- read_csv('analysis/1_gene_expression/norm_counts/CvvVenomReg_RepRNAseq_wNonVen_VSTNormCounts_08.02.21.csv') %>%
mutate(avg1DPE = rowMeans(.[,c(4,8,9)])) %>%
select(txid = 1, avg1DPE)
cvv.exp <- read_csv('analysis/1_gene_expression/norm_counts/CvvVenomReg_RepRNAseq_wNonVen_VSTNormCounts_08.02.21.csv') %>%
mutate(avg1DPE = rowMeans(.[,c(4,8,9)])) %>%
select(txid = 1, avg1DPE) %>%
mutate(txid = str_split_fixed(txid,'[_]',2)[,2])
cvv.gff <- read_tsv('data/annotation/CroVir_rnd1.all.maker.final.homologIDs.updatedNov2019.GeneEntriesOnly.gff')
cvv.gff <- read_tsv('data/annotation/CroVir_rnd1.all.maker.final.homologIDs.updatedNov2019.GeneEntriesOnly.gff',col_names = F)
View(cvv.gff)
cvv.gff <- read_tsv('data/annotation/CroVir_rnd1.all.maker.final.homologIDs.updatedNov2019.GeneEntriesOnly.gff',col_names = F) %>%
select(chr=1,start=4,end=5,desc=9)
cvv.gff <- read_tsv('data/annotation/CroVir_rnd1.all.maker.final.homologIDs.updatedNov2019.GeneEntriesOnly.gff',col_names = F) %>%
select(chr=1,start=4,end=5,desc=9) %>%
mutate(txid = str_split_fixed(desc,'[;]',4)[,3])
cvv.gff <- read_tsv('data/annotation/CroVir_rnd1.all.maker.final.homologIDs.updatedNov2019.GeneEntriesOnly.gff',col_names = F) %>%
select(chr=1,start=4,end=5,desc=9) %>%
filter(str_detect(desc,'trnascan',negate = T)) %>%
mutate(txid = str_split_fixed(desc,'[;]',4)[,3])
cvv.gff <- read_tsv('data/annotation/CroVir_rnd1.all.maker.final.homologIDs.updatedNov2019.GeneEntriesOnly.gff',col_names = F) %>%
select(chr=1,start=4,end=5,desc=9) %>%
filter(str_detect(desc,'trnascan',negate = T)) %>%
mutate(txid = str_split_fixed(desc,'[;]',4)[,3]) %>%
mutate(txid = str_remove(txid,'Crovir_Transcript_ID=c'))
cvv.gff <- read_tsv('data/annotation/CroVir_rnd1.all.maker.final.homologIDs.updatedNov2019.GeneEntriesOnly.gff',col_names = F) %>%
select(chr=1,start=4,end=5,desc=9) %>%
filter(str_detect(desc,'trnascan',negate = T)) %>%
mutate(txid = str_split_fixed(desc,'[;]',4)[,3]) %>%
mutate(txid = str_remove(txid,'Crovir_Transcript_ID='))
cvv.gff <- read_tsv('data/annotation/CroVir_rnd1.all.maker.final.homologIDs.updatedNov2019.GeneEntriesOnly.gff',col_names = F) %>%
select(chr=1,start=4,end=5,desc=9) %>%
filter(str_detect(desc,'trnascan',negate = T)) %>%
mutate(txid = str_split_fixed(desc,'[;]',4)[,3]) %>%
mutate(txid = str_remove(txid,'Crovir_Transcript_ID=')) %>%
select(1,2,3,5)
cvv.exp.gff <- cvv.exp %>%
left_join(cvv.gff)
View(cvv.exp.gff)
cvv.exp.gff <- cvv.exp %>%
left_join(cvv.gff) %>%
select(chr,start,end,avg1DPE)
cvv.exp.gff <- cvv.exp %>%
left_join(cvv.gff) %>%
select(chr,start,end,avg1DPE) %>%
left_join(cvv.chroms,by=c('chr'='old_id'))
cvv.exp.gff <- cvv.exp %>%
left_join(cvv.gff) %>%
left_join(cvv.chroms,by=c('chr'='old_id'))
cvv.exp.gff <- cvv.exp %>%
left_join(cvv.gff) %>%
left_join(cvv.chroms,by=c('chr'='old_id')) %>%
select(chr = 6, start=4, end=5, avg1DPE)
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = NULL)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08,panel.fun = function(x, y) {
circos.genomicAxis(h = "bottom", direction = "inside",labels.cex = 0.5)}
)
genomicLines(cvv.exp.gff)
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1,line_lwd = 0)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
######
###### Run this whole block together each time
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = NULL)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08,panel.fun = function(x, y) {
circos.genomicAxis(h = "bottom", direction = "inside",labels.cex = 0.5)}
)
circos.genomicLines(cvv.exp.gff)
circos.genomicLines(cvv.exp.gff,value = cvv.exp.gff$avg1DPE)
circos.genomicLines(sector.index = cvv.exp.gff$chr,x=mean(c(cvv.exp.gff$start,cvv.exp.gff$end)),y = cvv.exp.gff$avg1DPE)
circos.genomicLines(region=cvv.exp.gff)
circos.genomicLines(region=cvv.exp.gff,value = 1)
###### Run this whole block together each time
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = NULL)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08,panel.fun = function(x, y) {
circos.genomicAxis(h = "bottom", direction = "inside",labels.cex = 0.5)}
)
circos.genomicTrackPlotRegion(data, panel.fun = function(region, value, ...) {
circos.genomicPoints(region, value)
})
circos.genomicPoints(cvv.exp.gff, value)
circos.genomicPoints(cvv.exp.gff, cvv.exp.gff$avg1DPE)
circos.genomicTrackPlotRegion(cvv.exp.gff, panel.fun = function(region, value, ...) {
circos.genomicPoints(cvv.exp.gff, cvv.exp.gff$avg1DPE)
})
###### Run this whole block together each time
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = NULL)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08,panel.fun = function(x, y) {
circos.genomicAxis(h = "bottom", direction = "inside",labels.cex = 0.5)}
)
circos.genomicTrackPlotRegion(cvv.exp.gff, panel.fun = function(region, value, ...) {
circos.genomicPoints(cvv.exp.gff, cvv.exp.gff$avg1DPE)
})
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1,line_lwd = 0)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
circos.par(start.degree=90,gap.degree=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,10))
circos.genomicInitialize(cvv.chroms,plotType = NULL)
circos.track(ylim = c(0, 1),
bg.col = cvv.chroms$color,
bg.border = 'black', track.height = 0.08,panel.fun = function(x, y) {
circos.genomicAxis(h = "bottom", direction = "inside",labels.cex = 0.5)}
)
circos.genomicTrackPlotRegion(cvv.exp.gff, panel.fun = function(region, value, ...) {
circos.genomicLines(cvv.exp.gff, cvv.exp.gff$avg1DPE)
})
circos.genomicLabels(cvv.chroms, labels.column = 1, side = "inside",niceFacing = T,cex = 1,line_lwd = 0)
# circos.track(ylim = c(0, 1), panel.fun = function(x, y) {
#   chr = CELL_META$sector.index
#   xlim = CELL_META$xlim
#   ylim = CELL_META$ylim
#   circos.rect(xlim[1], 0, xlim[2], 1, col = c('green','white'))
#   circos.text(mean(xlim), mean(ylim), chr, cex = 0.7, col = "black",
#               facing = "inside", niceFacing = TRUE)
# }, track.height = 0.15, bg.border = NA)
circos.clear()
######
